<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Setup - flare</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Setup";
    var mkdocs_page_input_path = "setup.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> flare</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Setup</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#html-skeleton">HTML skeleton</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#writing-huger-apps">Writing huger apps</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../config/">Configuration</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../html5/">html5</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">flare</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Setup</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="setup">Setup</h1>
<p>Setting up a new Python web-app with <em>flare</em> is fairly easy. This section describes several things and ways how <em>flare</em> can be used and configured.</p>
<h2 id="html-skeleton">HTML skeleton</h2>
<p>Below is a shortened version of the code from <em>hello.html</em> delivered together with the <em>flare</em> repo. Such a skeleton must be individually created for an app written with <em>flare</em>.</p>
<pre><code class="html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;assets/css/style.min.css&quot;/&gt;

    &lt;!-- (1) --&gt;
    &lt;script src=&quot;https://pyodide-cdn2.iodide.io/v0.15.0/full/pyodide.js&quot;&gt;&lt;/script&gt;
    &lt;!-- &lt;script src=&quot;pyodide/pyodide.js&quot;&gt;&lt;/script&gt; --&gt;

    &lt;!-- (2) --&gt;
    &lt;script src=&quot;assets/js/init.js&quot;&gt;&lt;/script&gt;

    &lt;script&gt;
        window.addEventListener(
                &quot;load&quot;,
                (event) =&gt; {
                    window.init = new init({
                        prelude:                    // (3)
`
print(&quot;I'm before any fetch&quot;)
`
                        fetch: {                    // (4)
                            &quot;flare&quot;: {
                                &quot;path&quot;: &quot;flare&quot;
                            }
                        },
                        kickoff:                    // (5)
`
from flare import *
html5.Body().appendChild('&lt;a href=&quot;https://www.viur.dev&quot;&gt;Hello World&lt;/a&gt;')
flare.popup.Alert(&quot;Hello World&quot;)
`
                    });
                }
        );
    &lt;/script&gt;
&lt;/head&gt;
&lt;body class=&quot;is-loading&quot;&gt; &lt;!-- (6) --&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Notable are the following sections:</p>
<ol>
<li>This is the include for the used Pyodide version. When quickly setting up a project, the default CDN version of Pyodide can be used and is loaded from here. Indeed, it is also possible to serve Pyodide on your own. For this, the utility script <code>bin/get-pyodide.py</code> can be used. This script downloads a minimal version of Pyodide delivered from the CDN and stores it into a folder named <code>pyodide/</code>. In such a case, the CDN-include here must be removed, and replaced by the local include. <code>get-pyodide.py</code> patches some Pyodide-files to directly run from the URL <code>/pyodide</code>. You can override this setting by specifying a variable <code>window.languagePluginLoader</code> before including the <code>pyodide.js</code>.</li>
<li><em>flare</em> serves a piece of JavaScript code that is necessary to pre-load flare itself and the Python application. For development, it was useful to directly fetch the py-files from the server and store them into a browser-internal filesystem when the Python interpreter from Pyodide can find it. This is done using the module in <code>init.js</code> and the configuration described next.</li>
<li><code>prelude</code> is some Python code that is executed before any modules are fetched. It can be omitted, if not wanted.</li>
<li><code>fetch</code> describes Python source modules that are being fetched before the application starts. This is very useful for development purposes. For every entry (which is the name of the Python package to be created), a further object describing the fetch <code>path</code> and an optional <code>optional</code> attribute is provided. Using the <code>path</code>-attribute, the <em>flare</em> init script looks for a file <code>files.json</code> which provides a listing of the files being fetched. This file is generated using <code>bin/gen-files-json.py</code> which is described below. A Pyodide package can also be pre-compiled from source files, but this is not described in detail here, yet.</li>
<li><code>kickoff</code> is the Python code that is executed when all fetching is done and nothing failed. It is used as the entry point to start the web-app. In the <em>hello.html</em> file, it is just some "Hello World" stuff dumped out using flare.</li>
<li>The class <code>is-loading</code> is automatically removed when the kickoff code successfully executed. It can be used to show a loading animation or something similar.</li>
</ol>
<h2 id="writing-huger-apps">Writing huger apps</h2>
<p>When writing huger apps with multiple Python files, the above example doesn't satisfy. For this case, an HTML-file like above still serves as the entry point for the app, but requires a little more configuration.</p>
<p>Let's thing about the following minimal setup for a huger app:</p>
<ul>
<li><code>/flare</code> is the flare repo serving as a library
_ <code>/myapp</code> contains our app, which exists only of the files</li>
<li><code>index.html</code> the app entry HTML</li>
<li><code>__init__.py</code> the app source code</li>
<li><code>files.json</code> which is the index file for the <em>flare</em> init script to find its sources</li>
</ul>
<p>We only describe the files in <code>/myapp</code>:</p>
<p><strong>index.html</strong></p>
<pre><code class="html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;script src=&quot;https://pyodide-cdn2.iodide.io/v0.15.0/full/pyodide.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;/flare/assets/js/init.js&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
        window.addEventListener(
                &quot;load&quot;,
                (event) =&gt; {
                    window.init = new init({
                        fetch: {
                            &quot;flare&quot;: {
                                &quot;path&quot;: &quot;/flare/flare&quot;
                            },
                            &quot;myapp&quot;: {
                                &quot;path&quot;: &quot;.&quot;
                            }
                        }
                    }
                );
            }
        );
    &lt;/script&gt;
&lt;/head&gt;
&lt;body class=&quot;is-loading&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p><strong><strong>init</strong>.py</strong>:</p>
<pre><code class="python">from flare import *

if __name__ == &quot;myapp&quot;:
    html5.Body().appendChild('&lt;a href=&quot;https://www.viur.dev&quot;&gt;Hello World&lt;/a&gt;')
    popup.Alert(&quot;Hello World&quot;)
</code></pre>

<p><strong>files.json</strong>:</p>
<pre><code class="json">[
  &quot;__init__.py&quot;
]
</code></pre>

<p>The <code>files.json</code> was simply generated using the by <code>../flare/bin/gen-files-json.py</code>. Whenever a Python file is added, this must be done once. The <code>files.json</code> should also be added to version control, to make the app run out-of-the-box.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../config/" class="btn btn-neutral float-right" title="Configuration">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../config/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
